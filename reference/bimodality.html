<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bimodality Analysis — bimodality • microbiome</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bimodality Analysis — bimodality"><meta property="og:description" content="Estimate bimodality scores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microbiome</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.21.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vignette.html">Introduction to the microbiome R package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/microbiome/microbiome/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bimodality Analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/microbiome/microbiome/blob/HEAD/R/bimodality.R" class="external-link"><code>R/bimodality.R</code></a></small>
    <div class="hidden name"><code>bimodality.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate bimodality scores.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bimodality</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"potential_analysis"</span>,</span>
<span>  peak.threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bw.adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bs.iter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  min.density <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A vector, matrix, or a phyloseq object</p></dd>


<dt>method</dt>
<dd><p>bimodality quantification method
('potential_analysis', 'Sarle.finite.sample', or 'Sarle.asymptotic').
If method='all', then a data.frame with all scores is returned.</p></dd>


<dt>peak.threshold</dt>
<dd><p>Mode detection threshold</p></dd>


<dt>bw.adjust</dt>
<dd><p>Bandwidth adjustment</p></dd>


<dt>bs.iter</dt>
<dd><p>Bootstrap iterations</p></dd>


<dt>min.density</dt>
<dd><p>minimum accepted density for a maximum;
as a multiple of kernel height</p></dd>


<dt>verbose</dt>
<dd><p>Verbose</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with following elements:</p><ul><li><p>scoreFraction of bootstrap samples where multiple modes are
observed</p></li>
<li><p>nmodesThe most frequently observed number of modes in
bootstrap sampling results.</p></li>
<li><p>resultsFull results of potential_analysis for each row of the
input matrix.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    
<ul><li><p>Sarle.finite.sample Coefficient of bimodality for
finite sample. See SAS 2012.</p></li>
<li><p>Sarle.asymptotic Coefficient of bimodality, used and described
in Shade et al. (2014) and Ellison AM (1987).</p></li>
<li><p>potential_analysis Repeats potential analysis
(Livina et al. 2010) multiple times with bootstrap sampling for
each row of the input data (as in Lahti et al. 2014) and returns
the bootstrap score.</p></li>
</ul><p>The coefficient lies in (0, 1).</p>
<p>The 'Sarle.asymptotic' version is defined as
$$b=(g^2 + 1) / k$$.
This is coefficient of bimodality from Ellison
AM Am. J. Bot. 1987, for microbiome analysis it has been used for
instance in Shade et al. 2014.
The formula for 'Sarle.finite.sample' (SAS 2012):
$$b=\frac{g^2 + 1}{k + (3(n-1)^2)/((n-2)(n-3))}$$
where n is sample size and 
In both formulas, \(g\) is sample skewness and \(k\) is the kth
standardized moment (also called the sample kurtosis, or
excess kurtosis).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Livina et al. (2010). Potential analysis 
reveals changing number of climate states during the last 60
kyr. <em>Climate of the Past</em>, 6, 77-82.</p></li>
<li><p>Lahti et al. (2014). Tipping elements of the human intestinal
ecosystem. <em>Nature Communications</em> 5:4344.</p></li>
<li><p>Shade et al. mBio 5(4):e01371-14, 2014.</p></li>
<li><p>AM Ellison, Am. J. Bot 74:1280-8, 1987.</p></li>
<li><p>SAS Institute Inc. (2012). SAS/STAT 12.1 user's guide. Cary, NC.</p></li>
<li><p>To cite the microbiome R package, see citation('microbiome')</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>A classical test of multimodality is provided by <code>dip.test</code>
in the <span class="pkg">DIP</span> package.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Leo Lahti <a href="mailto:leo.lahti@iki.fi">leo.lahti@iki.fi</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># In practice, use more bootstrap iterations   </span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">bimodality</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"Sarle.finite.sample"</span>, bs.iter<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The classical DIP test:</span></span></span>
<span class="r-in"><span><span class="co"># quantifies unimodality. Values range between 0 to 1. </span></span></span>
<span class="r-in"><span><span class="co"># dip.test(x, simulate.p.value=TRUE, B=200)$statistic</span></span></span>
<span class="r-in"><span><span class="co"># Values less than 0.05 indicate significant deviation from unimodality.</span></span></span>
<span class="r-in"><span><span class="co"># Therefore, to obtain an increasing multimodality score, use</span></span></span>
<span class="r-in"><span><span class="co"># library(diptest)</span></span></span>
<span class="r-in"><span><span class="co"># multimodality.dip &lt;- apply(abundances(pseq), 1,</span></span></span>
<span class="r-in"><span><span class="co"># function (x) {1 - unname(dip.test(x)$p.value)})</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leo Lahti, Sudarshan Shetty.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

